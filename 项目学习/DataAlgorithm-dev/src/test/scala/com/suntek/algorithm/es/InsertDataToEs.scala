package com.suntek.algorithm.es

import com.suntek.algorithm.common.http.HttpUtil
import com.suntek.algorithm.process.util.EsUtil
import io.searchbox.client.JestClient
import org.json4s.DefaultFormats
import org.json4s.jackson.Json

import java.text.SimpleDateFormat
import java.util.Date

object InsertDataToEs {

  val indexName = "relation_index"

  val elasticIps = "172.25.21.134:9401"
  var jestClient: JestClient = _

  def main(args: Array[String]): Unit = {

//
//    var data = List[(String, String)]()
//
//    var map = Map[String, Object]()
//
//    map += "id" -> "22"
//    map += "testName" -> "小米手机7"
//    map += "testTitle" -> "xm"
//    map += "testAge" -> "14"
//
//    data +:= (("22", Json(DefaultFormats).write(map)))
//
//    EsUtil.insertBatch(elasticIps, indexName, "_doc", data,  batchSize = 3)
//
//
//
//
//    println(EsUtil.regJson("{\"query\": {\"match_allefwefef\": \"45454\"}}"))
//    EsUtil.deleteData(elasticIps, indexName)
//    EsUtil.deleteIndexName(elasticIps, indexName)
//
//    val total = EsUtil.getTotal(elasticIps, indexName)
//    println(s"total: $total")
//


//    1 personId 1368892925282488320  1368892925282488321
//
//    2 car      1285553607000000001 1285553607000000002
//
//    3 phone    13756894252        13756894253
//
//    4 imei     863246008412345     863246008412346
//
//    5 imsi     255001350000998     255001350000999
//
//    6 mac     02-00-4C-4F-4F-50   02-00-4C-4F-4F-51
//
//    7 face    636724350177917696   636724350177917697
//
//    8 personbody  836724350177917696  836724350177917697
//
//    9 idcard  345689197510251256   345689198712302568

  // person-person=06-0006-0001-02
//    test("1368892925282488320", 1, "1368892925282488321", 1, relId = "06-0006-0001-02", relType = 2)
//
//  // person-personbody=06-0006-0001-03 (人员Id-人体Id要素关联)
//    test("1368892925282488320", 1, "836724350177917696", 8, relId = "06-0006-0001-03")
//    test("1368892925282488320", 1, "836724350177917697", 8, relId = "06-0006-0001-03")
//
//    test("1368892925282488321", 1, "836724350177917696", 8, relId = "06-0006-0001-03")
//    test("1368892925282488321", 1, "836724350177917697", 8, relId = "06-0006-0001-03")
//
//  //car-car=06-0007-0001-02
//    test("1285553607000000001", 2, "1285553607000000002", 2, relId = "06-0007-0001-02", relType = 2)
//
//  //phone-phone=08-0001-0001-02
//    test("13756894252", 3, "13756894253", 3, relId = "08-0001-0001-02", relType = 2)
  //imei-imei=08-0001-0002-02
//    test("863246008412345", 4, "863246008412346", 4, relId = "08-0001-0002-02", relType = 2)
  //imsi-imsi=08-0001-0003-02
//    test("255001350000998", 5, "255001350000999", 5, relId = "08-0001-0003-02", relType = 2)
  //mac-mac=08-0001-0004-02
//    test("02-00-4C-4F-4F-50", 6, "02-00-4C-4F-4F-51", 6, relId = "08-0001-0004-02", relType = 2)

  //phone-imei=04-0002-0004

    test("13756894252", 3, "100000000100049", 4, relId = "04-0002-0004")
    test("13756894252", 3, "863246008412346", 4, relId = "04-0002-0004")
    test("13756894253", 3, "863246008412345", 4, relId = "04-0002-0004")
    test("13756894253", 3, "863246008412346", 4, relId = "04-0002-0004")
 // phone-mac=04-0002-0005
    test("13756894252", 3, "BB:CB:DE:78:45:34", 6, relId = "04-0002-0005")
    test("13756894252", 3, "02-00-4C-4F-4F-51", 6, relId = "04-0002-0005")
    test("13756894253", 3, "02-00-4C-4F-4F-50", 6, relId = "04-0002-0005")
    test("13756894253", 3, "02-00-4C-4F-4F-51", 6, relId = "04-0002-0005")
// imei-imsi=04-0002-0006

//    test("863246008412345", 4, "255001350000998", 5, relId = "04-0002-0006")
//    test("863246008412345", 4, "255001350000999", 5, relId = "04-0002-0006")
//    test("863246008412346", 4, "255001350000998", 5, relId = "04-0002-0006")
//    test("863246008412346", 4, "255001350000999", 5, relId = "04-0002-0006")
// imei-mac=04-0002-0007
//    test("863246008412345", 4, "02-00-4C-4F-4F-50", 6, relId = "04-0002-0007")
//    test("863246008412345", 4, "02-00-4C-4F-4F-51", 6, relId = "04-0002-0007")
//    test("863246008412346", 4, "02-00-4C-4F-4F-50", 6, relId = "04-0002-0007")
//    test("863246008412346", 4, "02-00-4C-4F-4F-51", 6, relId = "04-0002-0007")
// person-phone=02-0002-0001

//    test("1368892925282488320", 1, "13756894252", 3, relId = "02-0002-0001")
//    test("1368892925282488320", 1, "13756894253", 3, relId = "02-0002-0001")
//    test("1368892925282488321", 1, "13756894252", 3, relId = "02-0002-0001")
//    test("1368892925282488321", 1, "13756894253", 3, relId = "02-0002-0001")
// person-imsi=02-0002-0003
    //    1 personId 1368892925282488320  1368892925282488321
    //    5 imsi     255001350000998     255001350000999

//        test("1368892925282488320", 1, "255001350000998", 5, relId = "02-0002-0003")
//        test("1368892925282488320", 1, "255001350000999", 5, relId = "02-0002-0003")
//        test("1368892925282488321", 1, "255001350000998", 5, relId = "02-0002-0003")
//        test("1368892925282488321", 1, "255001350000999", 5, relId = "02-0002-0003")
// person-imei=02-0002-0004
//
//    test("1368892925282488320", 1, "863246008412345", 4, relId = "02-0002-0004")
//    test("1368892925282488320", 1, "863246008412346", 4, relId = "02-0002-0004")
//    test("1368892925282488321", 1, "863246008412345", 4, relId = "02-0002-0004")
//    test("1368892925282488321", 1, "863246008412346", 4, relId = "02-0002-0004")

// person-mac=02-0002-0005

//    test("1368892925282488320", 1, "02-00-4C-4F-4F-50", 6, relId = "02-0002-0005")
//    test("1368892925282488320", 1, "02-00-4C-4F-4F-51", 6, relId = "02-0002-0005")
//    test("1368892925282488321", 1, "02-00-4C-4F-4F-50", 6, relId = "02-0002-0005")
//    test("1368892925282488321", 1, "02-00-4C-4F-4F-51", 6, relId = "02-0002-0005")
//person-car=02-0002-0006

//    test("1368892925282488320", 1, "1285553607000000001", 2, relId = "02-0002-0006")
//    test("1368892925282488320", 1, "1285553607000000002", 2, relId = "02-0002-0006")
//    test("1368892925282488321", 1, "1285553607000000001", 2, relId = "02-0002-0006")
//    test("1368892925282488321", 1, "1285553607000000002", 2, relId = "02-0002-0006")
//car-phone=03-0002-0001

//    test("1285553607000000001", 2, "13756894252", 3, relId = "03-0002-0001")
//    test("1285553607000000001", 2, "13756894253", 3, relId = "03-0002-0001")
//    test("1285553607000000002", 2, "13756894252", 3, relId = "03-0002-0001")
//    test("1285553607000000002", 2, "13756894253", 3, relId = "03-0002-0001")
//car-imsi=03-0003-0003

//    test("1285553607000000001", 2, "255001350000998", 5, relId = "03-0003-0003")
//    test("1285553607000000001", 2, "255001350000999", 5, relId = "03-0003-0003")
//    test("1285553607000000002", 2, "255001350000998", 5, relId = "03-0003-0003")
//    test("1285553607000000002", 2, "255001350000999", 5, relId = "03-0003-0003")
// car-imei=03-0003-0004


//    test("1285553607000000001", 2, "863246008412345", 4, relId = "03-0003-0004")
//    test("1285553607000000001", 2, "863246008412346", 4, relId = "03-0003-0004")
//    test("1285553607000000002", 2, "863246008412345", 4, relId = "03-0003-0004")
//    test("1285553607000000002", 2, "863246008412346", 4, relId = "03-0003-0004")

//car-mac=03-0003-0005
    //    2 car      1285553607000000001 1285553607000000002
    //    6 mac     02-00-4C-4F-4F-50   02-00-4C-4F-4F-51
//    var id1Type = 2
//    var id2Type = 6
//    var relId = "03-0003-0005"

//        test("1285553607000000001", id1Type, "02-00-4C-4F-4F-50", id2Type, relId)
//        test("1285553607000000001", id1Type, "02-00-4C-4F-4F-51", id2Type, relId)
//        test("1285553607000000002", id1Type, "02-00-4C-4F-4F-50", id2Type, relId)
//        test("1285553607000000002", id1Type, "02-00-4C-4F-4F-51", id2Type, relId)
//tsw=06-0004-0002-02
//tz=06-0004-0001-02
//    test("1368892925282488320", 1, "1368892925282488321", 1, relId = "06-0004-0002-02", relType = 2)
//    test("1368892925282488320", 1, "1368892925282488321", 1, relId = "06-0004-0001-02", relType = 2)
//person-person.samecar=07-0002-0001-03  共用车辆人员

//    test("1368892925282488320", 1, "1368892925282488321", 1, relId = "07-0002-0001-03", relType = 2)
//    test("1368892925282488320", 1, "1368892925282488321", 1, relId = "07-0002-0001-03", relType = 2)
//car-car.sameperson=07-0002-0001-04 (同驾乘人员车辆)

//    test("1285553607000000001", 2, "1285553607000000002", 2, relId = "07-0002-0001-04", relType = 2)


    //    1 personId 1368892925282488320  1368892925282488321
    //
    //    2 car      1285553607000000001 1285553607000000002
    //
    //    3 phone    13756894252        13756894253
    //
    //    4 imei     863246008412345     863246008412346
    //
    //    5 imsi     255001350000998     255001350000999
    //
    //    6 mac     02-00-4C-4F-4F-50   02-00-4C-4F-4F-51
    //
    //    7 face    636724350177917696   636724350177917697
    //
    //    8 personbody  836724350177917696  836724350177917697
    //
    //    9 idcard  345689197510251256   345689198712302568

// 08-0003-0001-02 共用手机号的IMEI
//        test("863246008412345", 4, "863246008412346", 4, relId = "08-0003-0001-02", relType = 2)
//
//////    08-0003-0002-02  共用手机号的MAC
//        test("02-00-4C-4F-4F-50", 6, "02-00-4C-4F-4F-51", 6, relId = "08-0003-0002-02", relType = 2)
//////      08-0003-0003-02  共用IMEI的手机号
//    test("13756894252", 3, "13756894253", 3, relId = "08-0003-0003-02", relType = 2)
//////      08-0003-0004-02   共用IMEI的IMSI
//    test("255001350000998", 5, "255001350000999", 5, relId = "08-0003-0004-02", relType = 2)
//////      08-0003-0005-02   共用MAC的手机号
//    test("13756894252", 3, "13756894253", 3, relId = "08-0003-0005-02", relType = 2)
//////      08-0003-0006-02  共用MAC的IMSI
//    test("255001350000998", 5, "255001350000999", 5, relId = "08-0003-0006-02", relType = 2)
//////      08-0003-0007-02   共用IMSI的IMEI
//        test("863246008412345", 4, "863246008412346", 4, relId = "08-0003-0007-02", relType = 2)
//////      08-0003-0008-02   共用IMSI的MAC
//        test("02-00-4C-4F-4F-50", 6, "02-00-4C-4F-4F-51", 6, relId = "08-0003-0008-02", relType = 2)

// IMEI-手机号码
    //    3 phone    13756894252        13756894253
    //
    //    4 imei     863246008412345     863246008412346
    //
    //    5 imsi     255001350000998     255001350000999
    //
    //    6 mac     02-00-4C-4F-4F-50   02-00-4C-4F-4F-51

//    test("863246008412345", 4, "13756894252", 3, relId = "04-0002-0004")
//    test("863246008412346", 4, "13756894252", 3, relId = "04-0002-0004")
//
//    test("863246008412345", 4, "13756894253", 3, relId = "04-0002-0004")
//    test("863246008412346", 4, "13756894253", 3, relId = "04-0002-0004")



  }

  def test(id1: String, id1Type: Int,
           id2: String, id2Type: Int, relId: String, relType: Int = 1): Unit = {
    val sdf = new SimpleDateFormat("yyyyMMddHHmmss")
    var map = Map[String, Object]()


    map += "ID1" -> id1
    map += "ID1_ATTR" -> HttpUtil.regJson("")
    map += "ID1_TYPE" -> id1Type.toString
    map += "ID2" -> id2
    map += "ID2_ATTR" -> HttpUtil.regJson("")
    map += "ID2_TYPE" -> id2Type.toString

    map += "REL_ID" -> relId
    map += "REL_TYPE" -> relType.toString
    map += "REL_ATTR" -> HttpUtil.regJson("")
    map += "REL_GEN_TYPE" -> "2"
    map += "FIRST_TIME" -> "20201214154020"
    map += "LAST_TIME" -> "20201214154420"
    map += "OCCUR_NUM" -> "30"
    map += "SCORE" -> "30"
    map += "FIRST_DEVICE_ID" -> "4401562"
    map += "LAST_DEVICE_ID" -> "4401589"

    map += "INSERT_TIME" -> sdf.format(new Date())

    val docId = s"${id1}_${id1Type}_${relId}_${id2}_$id2Type"

    println(docId)

    var data = List[(String, String)]()

    data +:= ((docId, Json(DefaultFormats).write(map)))

    EsUtil.insertBatch(elasticIps,  indexName, "_doc", data,  batchSize = 3)
  }
}
